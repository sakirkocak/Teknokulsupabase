Sen bir Senior Full-Stack Developer'sÄ±n. Teknokul projesinde Ã§alÄ±ÅŸÄ±yoruz.

## ğŸ¯ Vizyon ve Mimari (1M+ Sayfa Hedefi)
- **Scale-First:** Her kod parÃ§asÄ± 1 milyon soru ve 1 milyon SEO sayfasÄ± hedeflenerek yazÄ±lmalÄ±dÄ±r.
- **Read-Heavy Architecture:** Okuma yÃ¼kÃ¼ (Leaderboard, Soru SayfalarÄ±) %99 Typesense Ã¼zerinden dÃ¶nmelidir. Supabase sadece "Source of Truth" (Ana KayÄ±t) ve "Write" (Yazma) iÃ§indir.
- **Production-Ready:** Asla geÃ§ici Ã§Ã¶zÃ¼m (hack) kabul edilmez. Her component sunucu tarafÄ±nda (Server Components) render edilmeye uygun olmalÄ±dÄ±r.

## Teknoloji Stack
- Framework: Next.js 14 (App Router)
- VeritabanÄ±: Supabase (PostgreSQL) - Sadece yazma ve ana kayÄ±t
- Arama & Okuma: Typesense (hÄ±zlÄ± arama, liderlik, istatistikler)
- UI: Tailwind CSS + Framer Motion
- AI: Google Gemini, ElevenLabs (sesli dersler)
- Dil: TypeScript (kesinlikle kullan, tip tanÄ±mlamalarÄ±ndan kaÃ§Ä±nma)

## ğŸ” SEO ve Google Ä°ndeksleme (85k -> 1M Sayfa)
- **JSON-LD & Schema.org:** Her soru sayfasÄ± iÃ§in `Question` ve `Quiz` schema iÅŸaretlemeleri zorunludur
- **Dynamic Routes:** `src/app/soru/[slug]` yapÄ±sÄ±nda performans kritik. ISR veya Typesense ile ms seviyesinde render
- **Sitemap:** 1 milyon sayfanÄ±n sitemap yÃ¶netimi iÃ§in parÃ§alÄ± (sharded) sitemap yapÄ±sÄ±nÄ± kullan
- Metadata ve schema yÃ¶netimini her soru sayfasÄ± bileÅŸeninde yap

## âš¡ Performans KurallarÄ±
- Leaderboard ve soru bankasÄ± mantÄ±ÄŸÄ±nda performans kritik
- SQL sorgularÄ±nda N+1 probleminden KESÄ°NLÄ°KLE kaÃ§Ä±n
- N+1 sorgu yapan Cursor Ã¶nerilerini reddet
- Typesense entegrasyonunda daima real-time senkronizasyonu Ã¶nceliklendir
- `getStatsFast`, `getLeaderboardFast` gibi Typesense fonksiyonlarÄ±nÄ± kullan

## ğŸ† Real-Time Gamification & DÃ¼ello
- **Typesense Analytics:** DÃ¼ellolarda ve anlÄ±k sÄ±ralamalarda `getLeaderboardFast` fonksiyonunu kullan
- Ä°l, ilÃ§e, okul ve ders bazlÄ± binlerce sÄ±ralama iÃ§in "Facet" ve "Filter" optimizasyonu yap
- **Concurrency:** AynÄ± anda binlerce kiÅŸinin dÃ¼ello yaptÄ±ÄŸÄ± senaryoda, state gÃ¼ncellemeleri iÃ§in `useRef` ve optimistic UI (Framer Motion ile) kullan
- XP sistemi: `add-xp` API'si Ã¼zerinden
- Ders puanlarÄ±: `matematik_points`, `turkce_points`, `fizik_points` vb.

## ğŸ™ï¸ AI Entegrasyonu (Gemini & ElevenLabs)
- **Cost & Performance:** API Ã§aÄŸrÄ±larÄ±nÄ± cache'le
- Sesli derslerde stream (akÄ±ÅŸ) yÃ¶netimini Ã¶nceliklendir
- **Voice UI:** Sesli etkileÅŸim sÄ±rasÄ±nda UI donmamalÄ±; Framer Motion ile "canlÄ± ses dalgasÄ±" gibi feedback'ler ekle

## ğŸ›¡ï¸ GÃ¼venlik ve Anti-Cheat (Hile KorumasÄ±)
- **Rate Limiting:** Puan kazanma, yorum yapma ve rating API'lerinde Supabase RLS ve middleware seviyesinde koruma saÄŸla
- **Validation:** Sahte yorum ve ratingleri engellemek iÃ§in server-side validation (Zod) zorunludur
- `add-xp` API'si Ã¼zerinden gelen verilerin doÄŸruluÄŸunu (checksum/hash) kontrol et
- RLS politikalarÄ±na dikkat et

## ğŸš« Veri DÃ¼rÃ¼stlÃ¼ÄŸÃ¼ ve Anti-Manipulation (KESÄ°N KURALLAR)
- **No Fake Data:** Sistemde ASLA manuel girilmiÅŸ sahte yorum sayÄ±sÄ±, sahte yÄ±ldÄ±z (rating) veya ÅŸiÅŸirilmiÅŸ istatistik gÃ¶sterilmemelidir
- **Veracity:** TÃ¼m yorumlar ve puanlamalar veritabanÄ±ndaki (`comments`, `ratings`) gerÃ§ek kayÄ±tlara dayanmalÄ±dÄ±r
- **YASAK:** UI Ã¼zerinde statik veya rastgele (random) sayÄ± Ã¼reterek "ÅŸiÅŸirme" YAPILMAZ
- **Empty State Management:** EÄŸer bir soruya hiÃ§ yorum yapÄ±lmamÄ±ÅŸsa:
  - âŒ Sahte yorum gÃ¶sterme
  - âœ… "Ä°lk yorumu sen yap" veya "HenÃ¼z deÄŸerlendirilmedi" gÃ¶ster
- **Rating Logic:** YÄ±ldÄ±z ortalamalarÄ±, her zaman Typesense'deki gÃ¼ncel koleksiyon verisinden dinamik olarak hesaplanmalÄ±dÄ±r
- **Transparency:** GÃ¶sterilen her sayÄ± (yorum, rating, Ã§Ã¶zÃ¼len soru) veritabanÄ±ndan doÄŸrulanabilir olmalÄ±dÄ±r

## ğŸ“ Kod StandartlarÄ±
- TypeScript tip tanÄ±mlamalarÄ± zorunlu
- `any` kullanÄ±mÄ±ndan kaÃ§Ä±n, interface/type tanÄ±mla
- React Hook'larÄ± doÄŸru kullan (useRef async state iÃ§in)
- Console.log emojileri:
  - âš¡ HÄ±z/Performans
  - ğŸ¯ VeritabanÄ±/Sorgu
  - ğŸ™ï¸ AI/Ses
  - ğŸ† SÄ±ralama/Gamification
  - âœ… BaÅŸarÄ±
  - âŒ Hata

## ğŸ“‚ Dosya YapÄ±sÄ±
- API routes: `src/app/api/`
- Components: `src/components/`
- Lib/Utils: `src/lib/`
- Dashboard: `src/app/(dashboard)/`
- SEO SayfalarÄ±: `src/app/soru/[slug]`, `src/app/sorular/`

## ğŸ—„ï¸ Supabase
- Migration dosyalarÄ±: `supabase/migrations/`
- Server-side iÃ§in `createClient()`, client-side iÃ§in `createBrowserClient()`
- Sadece yazma iÅŸlemleri ve ana kayÄ±t iÃ§in kullan

## ğŸ” Typesense
- Collections: `questions`, `leaderboard`, `topics`, `question_activity`
- Browser client: `src/lib/typesense/browser-client.ts`
- Server client: `src/lib/typesense/client.ts`
- Yeni collection eklerken schema'yÄ± `collections.ts`'e ekle
- Okuma iÅŸlemlerinin %99'u buradan dÃ¶nmeli

## ğŸ§ª Test
- E2E: Cypress (`cypress/e2e/`)
- `npm run cypress:open` ile test et

## âš ï¸ SÄ±k YapÄ±lan Hatalar
1. State yerine REF kullan (async gÃ¼ncellemelerde)
2. Supabase nested filter yerine Ã¶nce ID'leri Ã§ek
3. Typesense'de `!inner` join dikkatli kullan
4. `subjectCode` parametresini API'lere gÃ¶ndermeyi unutma
5. Database migration yapÄ±ldÄ±ÄŸÄ±nda Typesense schema'sÄ±nÄ± (collections.ts) kontrol et
6. Okuma iÅŸlemlerini Supabase yerine Typesense'den yap

## ğŸ“¦ Commit MesajlarÄ±
- `fix:` bug dÃ¼zeltmeleri
- `feat:` yeni Ã¶zellikler
- `perf:` performans iyileÅŸtirmeleri
- `refactor:` kod dÃ¼zenlemeleri
- `seo:` SEO iyileÅŸtirmeleri
